{{ 'login-register.css' | asset_url | stylesheet_tag }}
<div class="row">
  <div class="small-12 columns">
    <div class="thb-form-container">
      <div class="thb-register-form">
        {% form 'create_customer', novalidate: 'novalidate' %}
          <h4>{{ 'customer.login_page.create_account' | t }}</h4>
          <p>{{ 'customer.login_page.create_account_description' | t }}</p>
          {% if form.errors %}
            <div class="form-notification error">
              {% render 'svg-icons' with 'thb-error' %}
              {{ form.errors | default_errors }}
            </div>
          {% endif %}
        <div class="create_form_wrapper">          
            <div class="fields">
            <div class="field">
              <label for="first_name">{{ 'customer.login_page.first_name' | t }}</label>
              <input
                type="text"
                name="customer[first_name]"
                class="full"
                value="{% if form.first_name %}{{ form.first_name }}{% endif %}"
                placeholder="{{ 'customer.login_page.first_name' | t }}"
              >              
            </div>
            <div class="field">
              <label for="last_name">{{ 'customer.login_page.last_name' | t }}</label>
              <input
                type="text"
                name="customer[last_name]"
                class="full"
                value="{% if form.last_name %}{{ form.last_name }}{% endif %}"
                placeholder="{{ 'customer.login_page.last_name' | t }}"
              >
              
            </div>
          </div>
          <div class="field">
            <label for="number">{{ 'customer.login_page.Mobile'| t }}</label>
            <div class="field--country_codee">
              <span>+971</span>
              <input
              type="number"
              placeholder= "{{ 'customer.login_page.mobile'| t }}"
              class="full numeric"
              name="number"
              id="mobile"
              pattern="[0-9]*"
              inputmode="numeric"
              required
            >
            </div>
            
          </div>
            <div class="field">
              <label for="email">{{ 'customer.login_page.email' | t }}</label>
              <input
                type="email"
                name="customer[email]"
                class="full {% if form.errors contains 'email' %}invalid{% endif %}"
                value=""
                placeholder="{{ 'customer.login_page.email' | t }}"
              >              
            </div>
            
            <div class="field">
              <label for="confirm_email">{{ 'customer.login_page.confirm_email' | t }}</label>
              <input
                type="email"
                name="customer[confirm_email]"
                class="full {% if form.errors contains 'confirm_email' %}invalid{% endif %}"
                value=""
                placeholder="{{ 'customer.login_page.confirm_email' | t }}"
              >              
            </div>          
          
          <div class="field" onclick="openPopup()">
            <label for="streetAddress">Street Address</label>
            <input type="text" name="streetAddress" id="streetAddress" readonly>
            <div class="location_icon">
              {% render 'svg-icons' with 'location' %}
            </div>
          </div>

          <div id="popup">
            <label for="additionalDetails">Additional Details</label>
            <textarea name="additionalDetails" id="additionalDetails"></textarea>
            <button onclick="savePopup(event)">Save</button>
          </div>

          <div class="field">
            <label for="address" name="address">{{ 'Address' }}</label>
            <textarea name="address" placeholder="{{ 'address' }}" class="full" id="address"></textarea>
            
          </div>
          
         <div class="fields">
          <div class="field">
            <label for="regi_city" name="city">{{ 'customer.addresses.city' | t }}</label>
            <select name="city" id="regi_city" placeholder="{{ 'customer.addresses.city' | t }}" class="full" onchange="getCityDistricts(this.value)">
              <option value="">{{ 'customer.addresses.city' | t }}</option>
            </select>          
          </div>

          <div class="field">
            <label for="district">{{ 'customer.addresses.district' | t }}</label>
            <select name="district" placeholder="{{ 'customer.addresses.district' | t }}" id="district" class="full">
              <option value="">{{ 'customer.addresses.district' | t }}</option>
            </select>            
          </div>
       </div>
          <div class="terms_condition-checkbox">
            <input type="checkbox"value="" required/>
            <span>I accept and agree to the Terms and Condition</span>
          </div>
          <button type="button" class="button full" id="regi_button">
            <span>{{ 'customer.login_page.submit_register' | t }}</span>
          </button>

          <div style="visibility:hidden;height:0">
            <div class="fields">
              <div class="field">
                  <label for="first_name">{{ 'customer.login_page.first_name' | t }}</label>
                <input
                  type="text"
                  name="customer[first_name]"
                  class="full"
                  value="{% if form.first_name %}{{ form.first_name }}{% endif %}"
                  placeholder="{{ 'customer.login_page.first_name' | t }}"
                >
              
              </div>
              <div class="field">
                <label for="last_name">{{ 'customer.login_page.last_name' | t }}</label>
                <input
                  type="text"
                  name="customer[last_name]"
                  class="full"
                  value="{% if form.last_name %}{{ form.last_name }}{% endif %}"
                  placeholder="{{ 'customer.login_page.last_name' | t }}"
                >
                
              </div>
            </div>
            <div class="field">
              <label for="email">{{ 'customer.login_page.email' | t }}</label>
              <input
                type="email"
                name="customer[email]"
                class="full {% if form.errors contains 'email' %}invalid{% endif %}"
                value=""
                placeholder="{{ 'customer.login_page.email' | t }}"
              >
              
            </div>
            <div class="field">
              <label for="password">{{ 'customer.login_page.password' | t }}</label>
              <input
                type="password"
                name="customer[password]"
                class="full"
                value=""
                placeholder="{{ 'customer.login_page.password' | t }}"
              >
              
            </div>
           
            <button type="submit" class="button full">
              <span>{{ 'customer.login_page.submit_register' | t }}</span>
            </button>
          </div>
      </div>
        {% endform %}
        <div class="switch-login-section">
          {{ 'customer.login_page.already_have_an_account' | t }}
          {% assign text_button_title = 'customer.login_page.login' | t %}
          {% render 'text-button', url: routes.account_login_url, title: text_button_title %}
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  /*** city and dis Start ***/
  document.addEventListener("DOMContentLoaded", function() {

      getCityDistricts(0);

    // document.getElementById("regi_button").addEventListener("click", function(event) {
    // });
  });

  function getCityDistricts(id){
      // alert(id);
      const apiUrl = 'https://alainuat.gdadmin.org/laravel/public/api/getCityDistricts/'+id;
      
      // Use the fetch function to make a GET request to the API
      fetch(apiUrl, {
        method: 'GET',
       
      })
      .then(response => {
        if (!response.ok) {
          throw new Error(`Network response was not ok: ${response.status}`);
        }
        
        return response.json();
      })
      .then(data => {
        // console.log('data', data.response);
        if(id == 0){
          let city = "<option>{{ 'customer.addresses.city' | t }}</option>";
          data.response.forEach(function (item) {
            city += `<option value="${item.id}">${item.city_name}</option>`;
          });
          document.getElementById("regi_city").innerHTML = city;
        }else{
          let districts = "<option>{{ 'customer.addresses.district' | t }}</option>";
          data.response.forEach(function (item) {
            districts += `<option value="${item.id}">${item.district_name}</option>`;
          });
          document.getElementById("district").innerHTML = districts;
        }
      })
      .catch(error => {
        // Handle errors that may occur during the fetch operation
        console.error('Error fetching data:', error);
      });
  }
/*** city and dis end ***/

/*** Pop up start ***/
  function openPopup() {
    document.getElementById('popup').style.display = 'block';
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
  }

  function savePopup(event) {
    // Add logic here to handle the data entered in the popup
    // For now, let's just close the popup without refreshing the page
    closePopup();

    // Prevent the default form submission behavior
    event.preventDefault();
  }
  
/*** Pop up End ***/
</script>
